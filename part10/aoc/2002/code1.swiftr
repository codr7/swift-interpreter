function max-calories(lines:List):Int (
  function sum-elf(current:Int max:Int):Int (
    function sum-line(line:String current:Int max:Int):Int
      if line
        sum-elf current.+ line.string-int max
      else
        sum-elf 0 if current.> max current max

    if lines
      sum-line lines.pop current max
    else
      max
  )
  
  sum-elf 0 0
)

max-calories "data1.txt".read-lines